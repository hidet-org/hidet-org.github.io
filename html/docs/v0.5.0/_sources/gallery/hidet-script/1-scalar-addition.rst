
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/hidet-script/1-scalar-addition.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_hidet-script_1-scalar-addition.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_hidet-script_1-scalar-addition.py:


Scalar Addition
===============

.. GENERATED FROM PYTHON SOURCE LINES 6-7

In this example, we will show you how to write a program that adds two float32 numbers.

.. GENERATED FROM PYTHON SOURCE LINES 9-10

We first import ``hidet`` and ``hidet.lang`` module, as well as set the cache directory.

.. GENERATED FROM PYTHON SOURCE LINES 10-15

.. code-block:: Python

    import hidet
    from hidet.lang import attrs

    hidet.option.cache_dir('./outs/cache')








.. GENERATED FROM PYTHON SOURCE LINES 16-19

There are a bunch of data types we can use in Hidet Script, and we can access them in ``hidet.lang.types`` module.
Each scalar data type has both a full name and a short name. For example, the short name of ``float32`` is
``f32``. They are equivalent and can be used interchangeably.

.. GENERATED FROM PYTHON SOURCE LINES 19-22

.. code-block:: Python

    from hidet.lang.types import f32









.. GENERATED FROM PYTHON SOURCE LINES 23-26

In the script function, we defined two parameters ``a`` and ``b`` with data type ``f32``. The return value of the
function is also ``f32``. In hidet script, it is **required** to annotate the data type of each parameter. If the
return type is not annotated, it will be treated as ``void`` data type.

.. GENERATED FROM PYTHON SOURCE LINES 26-39

.. code-block:: Python

    with hidet.script_module() as script_module:

        @hidet.script
        # In the following example, the datatype of a and b is 32-bit floating point number (f32),
        # and the function returns a f32 number.
        def launch(a: f32, b: f32) -> f32:
            attrs.func_kind = 'public'

            return a + b


    module = script_module.build()








.. GENERATED FROM PYTHON SOURCE LINES 40-42

We can invoke the compiled module with two float32 numbers as arguments, and it will return the sum of the two
numbers.

.. GENERATED FROM PYTHON SOURCE LINES 42-43

.. code-block:: Python

    print(module(3.0, 4.0))




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    7.0





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.002 seconds)


.. _sphx_glr_download_gallery_hidet-script_1-scalar-addition.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: 1-scalar-addition.ipynb <1-scalar-addition.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: 1-scalar-addition.py <1-scalar-addition.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: 1-scalar-addition.zip <1-scalar-addition.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
